---
title: "v0.94.4 Hammer released"
date: "2015-10-19"
author: "sage"
tags:
  - "release"
  - "hammer"
---

This Hammer point fixes several important bugs in Hammer, as well as fixing interoperability issues that are required before an upgrade to Infernalis. That is, all users of earlier version of Hammer or any version of Firefly will first need to upgrade to hammer v0.94.4 or later before upgrading to Infernalis (or future releases).

All v0.94.x Hammer users are strongly encouraged to upgrade.

### NOTABLE CHANGES

- build/ops: ceph.spec.in: 50-rbd.rules conditional is wrong ([issue#12166](http://tracker.ceph.com/issues/12166), [pr#5207](http://github.com/ceph/ceph/pull/5207), Nathan Cutler)
- build/ops: ceph.spec.in: ceph-common needs python-argparse on older distros, but doesn’t require it ([issue#12034](http://tracker.ceph.com/issues/12034), [pr#5216](http://github.com/ceph/ceph/pull/5216), Nathan Cutler)
- build/ops: ceph.spec.in: radosgw requires apache for SUSE only – makes no sense ([issue#12358](http://tracker.ceph.com/issues/12358), [pr#5411](http://github.com/ceph/ceph/pull/5411), Nathan Cutler)
- build/ops: ceph.spec.in: rpm: cephfs\_java not fully conditionalized ([issue#11991](http://tracker.ceph.com/issues/11991), [pr#5202](http://github.com/ceph/ceph/pull/5202), Nathan Cutler)
- build/ops: ceph.spec.in: rpm: not possible to turn off Java ([issue#11992](http://tracker.ceph.com/issues/11992), [pr#5203](http://github.com/ceph/ceph/pull/5203), Owen Synge)
- build/ops: ceph.spec.in: running fdupes unnecessarily ([issue#12301](http://tracker.ceph.com/issues/12301), [pr#5223](http://github.com/ceph/ceph/pull/5223), Nathan Cutler)
- build/ops: ceph.spec.in: snappy-devel for all supported distros ([issue#12361](http://tracker.ceph.com/issues/12361), [pr#5264](http://github.com/ceph/ceph/pull/5264), Nathan Cutler)
- build/ops: ceph.spec.in: SUSE/openSUSE builds need libbz2-devel ([issue#11629](http://tracker.ceph.com/issues/11629), [pr#5204](http://github.com/ceph/ceph/pull/5204), Nathan Cutler)
- build/ops: ceph.spec.in: useless %py\_requires breaks SLE11-SP3 build ([issue#12351](http://tracker.ceph.com/issues/12351), [pr#5412](http://github.com/ceph/ceph/pull/5412), Nathan Cutler)
- build/ops: error in ext\_mime\_map\_init() when /etc/mime.types is missing ([issue#11864](http://tracker.ceph.com/issues/11864), [pr#5385](http://github.com/ceph/ceph/pull/5385), Ken Dreyer)
- build/ops: upstart: limit respawn to 3 in 30 mins (instead of 5 in 30s) ([issue#11798](http://tracker.ceph.com/issues/11798), [pr#5930](http://github.com/ceph/ceph/pull/5930), Sage Weil)
- build/ops: With root as default user, unable to have multiple RGW instances running ([issue#10927](http://tracker.ceph.com/issues/10927), [pr#6161](http://github.com/ceph/ceph/pull/6161), Sage Weil)
- build/ops: With root as default user, unable to have multiple RGW instances running ([issue#11140](http://tracker.ceph.com/issues/11140), [pr#6161](http://github.com/ceph/ceph/pull/6161), Sage Weil)
- build/ops: With root as default user, unable to have multiple RGW instances running ([issue#11686](http://tracker.ceph.com/issues/11686), [pr#6161](http://github.com/ceph/ceph/pull/6161), Sage Weil)
- build/ops: With root as default user, unable to have multiple RGW instances running ([issue#12407](http://tracker.ceph.com/issues/12407), [pr#6161](http://github.com/ceph/ceph/pull/6161), Sage Weil)
- cli: ceph: cli throws exception on unrecognized errno ([issue#11354](http://tracker.ceph.com/issues/11354), [pr#5368](http://github.com/ceph/ceph/pull/5368), Kefu Chai)
- cli: ceph tell: broken error message / misleading hinting ([issue#11101](http://tracker.ceph.com/issues/11101), [pr#5371](http://github.com/ceph/ceph/pull/5371), Kefu Chai)
- common: arm: all programs that link to librados2 hang forever on startup ([issue#12505](http://tracker.ceph.com/issues/12505), [pr#5366](http://github.com/ceph/ceph/pull/5366), Boris Ranto)
- common: buffer: critical bufferlist::zero bug ([issue#12252](http://tracker.ceph.com/issues/12252), [pr#5365](http://github.com/ceph/ceph/pull/5365), Haomai Wang)
- common: ceph-object-corpus: add 0.94.2-207-g88e7ee7 hammer objects ([issue#13070](http://tracker.ceph.com/issues/13070), [pr#5551](http://github.com/ceph/ceph/pull/5551), Sage Weil)
- common: do not insert emtpy ptr when rebuild emtpy bufferlist ([issue#12775](http://tracker.ceph.com/issues/12775), [pr#5764](http://github.com/ceph/ceph/pull/5764), Xinze Chi)
- common: \[ FAILED \] TestLibRBD.BlockingAIO ([issue#12479](http://tracker.ceph.com/issues/12479), [pr#5768](http://github.com/ceph/ceph/pull/5768), Jason Dillaman)
- common: LibCephFS.GetPoolId failure ([issue#12598](http://tracker.ceph.com/issues/12598), [pr#5887](http://github.com/ceph/ceph/pull/5887), Yan, Zheng)
- common: Memory leak in Mutex.cc, pthread\_mutexattr\_init without pthread\_mutexattr\_destroy ([issue#11762](http://tracker.ceph.com/issues/11762), [pr#5378](http://github.com/ceph/ceph/pull/5378), Ketor Meng)
- common: object\_map\_update fails with -EINVAL return code ([issue#12611](http://tracker.ceph.com/issues/12611), [pr#5559](http://github.com/ceph/ceph/pull/5559), Jason Dillaman)
- common: Pipe: Drop connect\_seq increase line ([issue#13093](http://tracker.ceph.com/issues/13093), [pr#5908](http://github.com/ceph/ceph/pull/5908), Haomai Wang)
- common: recursive lock of md\_config\_t (0) ([issue#12614](http://tracker.ceph.com/issues/12614), [pr#5759](http://github.com/ceph/ceph/pull/5759), Josh Durgin)
- crush: ceph osd crush reweight-subtree does not reweight parent node ([issue#11855](http://tracker.ceph.com/issues/11855), [pr#5374](http://github.com/ceph/ceph/pull/5374), Sage Weil)
- doc: update docs to point to download.ceph.com ([issue#13162](http://tracker.ceph.com/issues/13162), [pr#6156](http://github.com/ceph/ceph/pull/6156), Alfredo Deza)
- fs: ceph-fuse 0.94.2-1trusty segfaults / aborts ([issue#12297](http://tracker.ceph.com/issues/12297), [pr#5381](http://github.com/ceph/ceph/pull/5381), Greg Farnum)
- fs: segfault launching ceph-fuse with bad –name ([issue#12417](http://tracker.ceph.com/issues/12417), [pr#5382](http://github.com/ceph/ceph/pull/5382), John Spray)
- librados: Change radosgw pools default crush ruleset ([issue#11640](http://tracker.ceph.com/issues/11640), [pr#5754](http://github.com/ceph/ceph/pull/5754), Yuan Zhou)
- librbd: correct issues discovered via lockdep / helgrind ([issue#12345](http://tracker.ceph.com/issues/12345), [pr#5296](http://github.com/ceph/ceph/pull/5296), Jason Dillaman)
- librbd: Crash during TestInternal.MultipleResize ([issue#12664](http://tracker.ceph.com/issues/12664), [pr#5769](http://github.com/ceph/ceph/pull/5769), Jason Dillaman)
- librbd: deadlock during cooperative exclusive lock transition ([issue#11537](http://tracker.ceph.com/issues/11537), [pr#5319](http://github.com/ceph/ceph/pull/5319), Jason Dillaman)
- librbd: Possible crash while concurrently writing and shrinking an image ([issue#11743](http://tracker.ceph.com/issues/11743), [pr#5318](http://github.com/ceph/ceph/pull/5318), Jason Dillaman)
- mon: add a cache layer over MonitorDBStore ([issue#12638](http://tracker.ceph.com/issues/12638), [pr#5697](http://github.com/ceph/ceph/pull/5697), Kefu Chai)
- mon: fix crush testing for new pools ([issue#13400](http://tracker.ceph.com/issues/13400), [pr#6192](http://github.com/ceph/ceph/pull/6192), Sage Weil)
- mon: get pools health’info have error ([issue#12402](http://tracker.ceph.com/issues/12402), [pr#5369](http://github.com/ceph/ceph/pull/5369), renhwztetecs)
- mon: implicit erasure code crush ruleset is not validated ([issue#11814](http://tracker.ceph.com/issues/11814), [pr#5276](http://github.com/ceph/ceph/pull/5276), Loic Dachary)
- mon: PaxosService: call post\_refresh() instead of post\_paxos\_update() ([issue#11470](http://tracker.ceph.com/issues/11470), [pr#5359](http://github.com/ceph/ceph/pull/5359), Joao Eduardo Luis)
- mon: pgmonitor: wrong at/near target max“ reporting ([issue#12401](http://tracker.ceph.com/issues/12401), [pr#5370](http://github.com/ceph/ceph/pull/5370), huangjun)
- mon: register\_new\_pgs() should check ruleno instead of its index ([issue#12210](http://tracker.ceph.com/issues/12210), [pr#5377](http://github.com/ceph/ceph/pull/5377), Xinze Chi)
- mon: Show osd as NONE in ceph osd map <pool> <object> output ([issue#11820](http://tracker.ceph.com/issues/11820), [pr#5376](http://github.com/ceph/ceph/pull/5376), Shylesh Kumar)
- mon: the output is wrong when runing ceph osd reweight ([issue#12251](http://tracker.ceph.com/issues/12251), [pr#5372](http://github.com/ceph/ceph/pull/5372), Joao Eduardo Luis)
- osd: allow peek\_map\_epoch to return an error ([issue#13060](http://tracker.ceph.com/issues/13060), [pr#5892](http://github.com/ceph/ceph/pull/5892), Sage Weil)
- osd: cache agent is idle although one object is left in the cache ([issue#12673](http://tracker.ceph.com/issues/12673), [pr#5765](http://github.com/ceph/ceph/pull/5765), Loic Dachary)
- osd: copy-from doesn’t preserve truncate\_{seq,size} ([issue#12551](http://tracker.ceph.com/issues/12551), [pr#5885](http://github.com/ceph/ceph/pull/5885), Samuel Just)
- osd: crash creating/deleting pools ([issue#12429](http://tracker.ceph.com/issues/12429), [pr#5527](http://github.com/ceph/ceph/pull/5527), John Spray)
- osd: fix repair when recorded digest is wrong ([issue#12577](http://tracker.ceph.com/issues/12577), [pr#5468](http://github.com/ceph/ceph/pull/5468), Sage Weil)
- osd: include/ceph\_features: define HAMMER\_0\_94\_4 feature ([issue#13026](http://tracker.ceph.com/issues/13026), [pr#5687](http://github.com/ceph/ceph/pull/5687), Sage Weil)
- osd: is\_new\_interval() fixes ([issue#10399](http://tracker.ceph.com/issues/10399), [pr#5691](http://github.com/ceph/ceph/pull/5691), Jason Dillaman)
- osd: is\_new\_interval() fixes ([issue#11771](http://tracker.ceph.com/issues/11771), [pr#5691](http://github.com/ceph/ceph/pull/5691), Jason Dillaman)
- osd: long standing slow requests: connection->session->waiting\_for\_map->connection ref cycle ([issue#12338](http://tracker.ceph.com/issues/12338), [pr#5761](http://github.com/ceph/ceph/pull/5761), Samuel Just)
- osd: Mutex Assert from PipeConnection::try\_get\_pipe ([issue#12437](http://tracker.ceph.com/issues/12437), [pr#5758](http://github.com/ceph/ceph/pull/5758), David Zafman)
- osd: pg\_interval\_t::check\_new\_interval - for ec pool, should not rely on min\_size to determine if the PG was active at the interval ([issue#12162](http://tracker.ceph.com/issues/12162), [pr#5373](http://github.com/ceph/ceph/pull/5373), Guang G Yang)
- osd: PGLog.cc: 732: FAILED assert(log.log.size() == log\_keys\_debug.size()) ([issue#12652](http://tracker.ceph.com/issues/12652), [pr#5763](http://github.com/ceph/ceph/pull/5763), Sage Weil)
- osd: PGLog::proc\_replica\_log: correctly handle case where entries between olog.head and log.tail were split out ([issue#11358](http://tracker.ceph.com/issues/11358), [pr#5380](http://github.com/ceph/ceph/pull/5380), Samuel Just)
- osd: read on chunk-aligned xattr not handled ([issue#12309](http://tracker.ceph.com/issues/12309), [pr#5367](http://github.com/ceph/ceph/pull/5367), Sage Weil)
- osd: suicide timeout during peering - search for missing objects ([issue#12523](http://tracker.ceph.com/issues/12523), [pr#5762](http://github.com/ceph/ceph/pull/5762), Guang G Yang)
- osd: WBThrottle::clear\_object: signal on cond when we reduce throttle values ([issue#12223](http://tracker.ceph.com/issues/12223), [pr#5757](http://github.com/ceph/ceph/pull/5757), Samuel Just)
- rbd: crash during shutdown after writeback blocked by IO errors ([issue#12597](http://tracker.ceph.com/issues/12597), [pr#5767](http://github.com/ceph/ceph/pull/5767), Jianpeng Ma)
- rgw: add delimiter to prefix only when path is specified ([issue#12960](http://tracker.ceph.com/issues/12960), [pr#5860](http://github.com/ceph/ceph/pull/5860), Sylvain Baubeau)
- rgw: create a tool for orphaned objects cleanup ([issue#9604](http://tracker.ceph.com/issues/9604), [pr#5717](http://github.com/ceph/ceph/pull/5717), Yehuda Sadeh)
- rgw: don’t preserve acls when copying object ([issue#11563](http://tracker.ceph.com/issues/11563), [pr#6039](http://github.com/ceph/ceph/pull/6039), Yehuda Sadeh)
- rgw: don’t preserve acls when copying object ([issue#12370](http://tracker.ceph.com/issues/12370), [pr#6039](http://github.com/ceph/ceph/pull/6039), Yehuda Sadeh)
- rgw: don’t preserve acls when copying object ([issue#13015](http://tracker.ceph.com/issues/13015), [pr#6039](http://github.com/ceph/ceph/pull/6039), Yehuda Sadeh)
- rgw: Ensure that swift keys don’t include backslashes ([issue#7647](http://tracker.ceph.com/issues/7647), [pr#5716](http://github.com/ceph/ceph/pull/5716), Yehuda Sadeh)
- rgw: GWWatcher::handle\_error -> common/Mutex.cc: 95: FAILED assert(r == 0) ([issue#12208](http://tracker.ceph.com/issues/12208), [pr#6164](http://github.com/ceph/ceph/pull/6164), Yehuda Sadeh)
- rgw: HTTP return code is not being logged by CivetWeb ([issue#12432](http://tracker.ceph.com/issues/12432), [pr#5498](http://github.com/ceph/ceph/pull/5498), Yehuda Sadeh)
- rgw: init\_rados failed leads to repeated delete ([issue#12978](http://tracker.ceph.com/issues/12978), [pr#6165](http://github.com/ceph/ceph/pull/6165), Xiaowei Chen)
- rgw: init some manifest fields when handling explicit objs ([issue#11455](http://tracker.ceph.com/issues/11455), [pr#5732](http://github.com/ceph/ceph/pull/5732), Yehuda Sadeh)
- rgw: Keystone Fernet tokens break auth ([issue#12761](http://tracker.ceph.com/issues/12761), [pr#6162](http://github.com/ceph/ceph/pull/6162), Abhishek Lekshmanan)
- rgw: region data still exist in region-map after region-map update ([issue#12964](http://tracker.ceph.com/issues/12964), [pr#6163](http://github.com/ceph/ceph/pull/6163), dwj192)
- rgw: remove trailing :port from host for purposes of subdomain matching ([issue#12353](http://tracker.ceph.com/issues/12353), [pr#6042](http://github.com/ceph/ceph/pull/6042), Yehuda Sadeh)
- rgw: rest-bench common/WorkQueue.cc: 54: FAILED assert(\_threads.empty()) ([issue#3896](http://tracker.ceph.com/issues/3896), [pr#5383](http://github.com/ceph/ceph/pull/5383), huangjun)
- rgw: returns requested bucket name raw in Bucket response header ([issue#12537](http://tracker.ceph.com/issues/12537), [pr#5715](http://github.com/ceph/ceph/pull/5715), Yehuda Sadeh)
- rgw: segmentation fault when rgw\_gc\_max\_objs > HASH\_PRIME ([issue#12630](http://tracker.ceph.com/issues/12630), [pr#5719](http://github.com/ceph/ceph/pull/5719), Ruifeng Yang)
- rgw: segments are read during HEAD on Swift DLO ([issue#12780](http://tracker.ceph.com/issues/12780), [pr#6160](http://github.com/ceph/ceph/pull/6160), Yehuda Sadeh)
- rgw: setting max number of buckets for user via ceph.conf option ([issue#12714](http://tracker.ceph.com/issues/12714), [pr#6166](http://github.com/ceph/ceph/pull/6166), Vikhyat Umrao)
- rgw: Swift API: X-Trans-Id header is wrongly formatted ([issue#12108](http://tracker.ceph.com/issues/12108), [pr#5721](http://github.com/ceph/ceph/pull/5721), Radoslaw Zarzynski)
- rgw: testGetContentType and testHead failed ([issue#11091](http://tracker.ceph.com/issues/11091), [pr#5718](http://github.com/ceph/ceph/pull/5718), Radoslaw Zarzynski)
- rgw: testGetContentType and testHead failed ([issue#11438](http://tracker.ceph.com/issues/11438), [pr#5718](http://github.com/ceph/ceph/pull/5718), Radoslaw Zarzynski)
- rgw: testGetContentType and testHead failed ([issue#12157](http://tracker.ceph.com/issues/12157), [pr#5718](http://github.com/ceph/ceph/pull/5718), Radoslaw Zarzynski)
- rgw: testGetContentType and testHead failed ([issue#12158](http://tracker.ceph.com/issues/12158), [pr#5718](http://github.com/ceph/ceph/pull/5718), Radoslaw Zarzynski)
- rgw: testGetContentType and testHead failed ([issue#12363](http://tracker.ceph.com/issues/12363), [pr#5718](http://github.com/ceph/ceph/pull/5718), Radoslaw Zarzynski)
- rgw: the arguments ‘domain’ should not be assigned when return false ([issue#12629](http://tracker.ceph.com/issues/12629), [pr#5720](http://github.com/ceph/ceph/pull/5720), Ruifeng Yang)
- tests: qa/workunits/cephtool/test.sh: don’t assume crash\_replay\_interval=45 ([issue#13406](http://tracker.ceph.com/issues/13406), [pr#6172](http://github.com/ceph/ceph/pull/6172), Sage Weil)
- tests: TEST\_crush\_rule\_create\_erasure consistently fails on i386 builder ([issue#12419](http://tracker.ceph.com/issues/12419), [pr#6201](http://github.com/ceph/ceph/pull/6201), Loic Dachary)
- tools: ceph-disk zap should ensure block device ([issue#11272](http://tracker.ceph.com/issues/11272), [pr#5755](http://github.com/ceph/ceph/pull/5755), Loic Dachary)

For more detailed information, see [the complete changelog](http://docs.ceph.com/docs/master/_downloads/v0.94.4.txt).

### GETTING CEPH

- Git at [git://github.com/ceph/ceph.git](http://github.com/ceph/ceph)
- Tarball at [http://ceph.com/download/ceph-0.94.4.tar.gz](http://ceph.com/download/ceph-0.94.4.tar.gz)
- For packages, see [http://ceph.com/docs/master/install/get-packages](http://ceph.com/docs/master/install/get-packages)
- For ceph-deploy, see [http://ceph.com/docs/master/install/install-ceph-deploy](http://ceph.com/docs/master/install/install-ceph-deploy)
